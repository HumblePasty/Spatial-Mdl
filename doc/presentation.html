<!DOCTYPE html>
<html lang="en"><head>
<script src="presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Map Mad Scientists Kunxi Li, Haolin Li, Jiayuan Xiao">
  <title>Final Project Presentation Biostat 696</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link href="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Final Project Presentation<br>Biostat 696</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Map Mad Scientists<br>Kunxi Li, Haolin Li, Jiayuan Xiao 
</div>
</div>
</div>

</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<div style="text-align:center;">
<p><strong>Light Pollution</strong></p>
<p><img src="./presentation.assets/35732ace7b56363ff57b7f79f401ecb.jpg" alt="I took this in Kunming, Yunnan, " style="zoom: 33%;"></p>
<div style="font-size:0.6em;">
<p>Winter night in Kunming, Yunan, China, Jan 16, 2023</p>
</div>
</div>
</section>
<section id="motivation-1" class="slide level2 smaller">
<h2>Motivation</h2>
<ul>
<li><p><strong>Magnitude of Celestial Body</strong></p>
<ul>
<li>Range <span class="math inline">\([-26.73, 30]\)</span></li>
<li>Sun -26.73</li>
<li>Full moon -12.6</li>
<li>Faintest stars observable with naked eye +6</li>
</ul></li>
<li><p><strong>Naked Eye Limiting Magnitude (<code>NELM</code>)</strong></p></li>
<li><p><strong>Magnitude Per Square Arcsecond (<code>MPSAS</code>)</strong> <span class="math display">\[
NELM = \text{some complex function}(MPSAS)
\]</span></p>
<ul>
<li>Range <span class="math inline">\([16 (brightest) - 22 (darkest)]\)</span></li>
<li>Measured by equipment (Sky Quality Meter)</li>
</ul></li>
</ul>
</section>
<section id="data-source" class="slide level2">
<h2>Data Source</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div style="font-size:0.7em;">
<p><strong>Globe at Night Project</strong> (<a href="https://globeatnight.org/maps-data/">Link</a>)</p>
<ul>
<li>Light pollution report at <code>29404</code> locations (2020)</li>
<li>Sky brightness measurement (<code>MPSAS</code>) at <code>2030</code> locations
<ul>
<li>Around <code>800</code> inside continental US</li>
</ul></li>
<li>Darker means higher <code>NELM</code> (less light pollution)</li>
</ul>
</div>
</div><div class="column" style="width:65%;">
<div style="text-align:center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./presentation.assets/2023-map.original.png"></p>
<figcaption><code>NELM</code> at All Report Locations in 2020</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="data-source-1" class="slide level2 smaller">
<h2>Data Source</h2>
<p><strong>Explanatory Variables</strong></p>
<ul>
<li><strong>Population Density<sup>1</sup></strong></li>
<li><strong>Land Price<sup>2</sup></strong></li>
<li><strong>Electricity Consumption<sup>3</sup></strong></li>
</ul>
<p>All are raster datasets and are sampled at the same locations as <code>MPSAS</code> measurements.</p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Center for International Earth Science Information Network - CIESIN - Columbia University. 2018. Gridded Population of the World, Version 4 (GPWv4): Population Density Adjusted to Match 2015 Revision UN WPP Country Totals, Revision 11. Palisades, New York: NASA Socioeconomic Data and Applications Center (SEDAC). https://doi.org/10.7927/H4F47M65. Accessed 22 04 2024.</p></li><li id="fn2"><p>Nolte, Christoph (2020). Data for: High-resolution land value maps reveal underestimation of conservation costs in the United States [Dataset]. Dryad. https://doi.org/10.5061/dryad.np5hqbzq9</p></li><li id="fn3"><p>Chen, Jiandong; Gao, Ming (2021). Global 1 km × 1 km gridded revised real gross domestic product and electricity consumption during 1992-2019 based on calibrated nighttime light data. figshare. Dataset. https://doi.org/10.6084/m9.figshare.17004523.v1</p></li></ol></aside></section>
<section id="our-goal" class="slide level2">
<h2>Our Goal</h2>
<div style="font-size:0.9em;">
<ul>
<li>Apply different spatial Bayesian models and compare performance;</li>
<li>Impute missing or damaged data in the original dataset (due to unofficial reports);</li>
<li>Predict light pollution in Michigan.</li>
</ul>
</div>
</section>
<section id="our-model" class="slide level2 smaller">
<h2>Our Model</h2>
<div style="font-size:0.9em;">
<p><span class="math display">\[
y(s) = \beta^Tx(s) + w(s) + \epsilon(s), s\in D
\]</span></p>
<p><strong>Response Variable</strong>: <span class="math display">\[
y(s)
\]</span></p>
<ul>
<li><code>MPSAS</code> measurement at location <span class="math inline">\(s\)</span> (Univariate)</li>
</ul>
<p><strong>Explanatory Variables</strong> <span class="math display">\[
x(s) = [x_1(s), x_2(s), x_3(s), x_4(s)]^T
\]</span></p>
<ul>
<li><span class="math inline">\(x_1\)</span>: Elevation</li>
<li><span class="math inline">\(x_2\)</span>: Population Density</li>
<li><span class="math inline">\(x_3\)</span>: Land Price</li>
<li><span class="math inline">\(x_4\)</span>: Electricity Consumption</li>
</ul>
</div>
</section>
<section id="model-assumptions---gp" class="slide level2 smaller">
<h2>Model Assumptions - GP</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="math inline">\(w(s) \sim GP(0, \tau^2C(\cdot,\cdot))\)</span></p></li>
<li><p>Features</p>
<ul>
<li><p>Rapid decay in covariance</p></li>
<li><p>Stationary, isotropic (?)</p></li>
</ul></li>
<li><p>Exponential kernel <span class="math display">\[
C(s, s') = \sigma^2 \exp{-\phi||s - s'||}
\]</span></p>
<ul>
<li>For simplicity</li>
<li>Interpretability</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div style="text-align:center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./presentation.assets/snapshot-2021-05-03T00_00_00Z-1713928280926-2.png"></p>
<figcaption>Nighttime Light Image Captured in NASA Worldview<sup>1</sup></figcaption>
</figure>
</div>
</div>
<div style="font-size:0.8em;">
<p><em>Why not use night time light data as an explanatory variable?</em></p>
<ul>
<li>Only measuring differences</li>
<li>Does not explain anything</li>
</ul>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn4"><p>Román, M. O., Wang, Z., Sun, Q., Kalb, V., Miller, S. D., Molthan, A., … &amp; Masuoka, E. J. (2018). NASA’s Black Marble nighttime lights product suite. Remote Sensing of Environment, 210, 113-143, <a href="https://doi.org/10.1016/j.rse.2018.03.017">doi:10.1016/j.rse.2018.03.017</a>.</p></li></ol></aside></section>
<section id="model-assumptions---priors" class="slide level2 smaller">
<h2>Model Assumptions - Priors</h2>
<div style="text-align:center;">
<p><img src="./presentation.assets/Variogram_fit.png" style="zoom: 10%;"></p>
</div>
<p>The residual plot of semivariance from nonspatial model could help with our decision of the prior and starting value settings (Banerjee, Carlin, and Gelfand (2014))</p>
<ul>
<li><span class="math inline">\(\beta \sim N(0, 1000I_p)\)</span>
<ul>
<li>We assume independence between explanatory variables</li>
</ul></li>
</ul>
</section>
<section id="model-assumptions---priors-1" class="slide level2 smaller">
<h2>Model Assumptions - Priors</h2>
<ul>
<li><span class="math inline">\(\phi \sim U(3/20, 3/0.1)\)</span>
<ul>
<li><p>Since we plan to use exponential model to specify the covariance function, where the spatial correlation is given by</p>
<p><span class="math display">\[p(d)=exp(-d/\phi)\]</span> we define the distance, <span class="math inline">\(d_0\)</span> , at which this correlation drops to 0.05 as the “effective spatial range” ,then <span class="math display">\[
\phi =  log(0.5)/d_0\approx 3/d_0
\]</span></p></li>
<li><p>We assume large decay factor</p></li>
<li><p>Starting value: 3/10, since the range of the semi-variogram is close to 10</p></li>
</ul></li>
</ul>
</section>
<section id="model-assumptions---priors-2" class="slide level2 smaller">
<h2>Model Assumptions - Priors</h2>
<ul>
<li><span class="math inline">\(\sigma^2 \sim Inv.G(2, 2)\)</span>
<ul>
<li>Chose because the sill value of residuals plot is close to 0.5</li>
<li>Starting value: same as 0.5</li>
</ul></li>
<li><span class="math inline">\(\tau^2 \sim Inv.G(2, 0.1)\)</span>
<ul>
<li>Chose because we think the mean value of <span class="math inline">\(\tau^2\)</span> should be a small number</li>
<li>Starting value 0.1, since the nugget value of the plot is close to 0.</li>
</ul></li>
<li>Tuning: <span class="math inline">\(\phi=0.05, \tau^2=0.01, \sigma^2=0.01\)</span></li>
</ul>
</section>
<section id="mcmc-trace---full-gp" class="slide level2 smaller">
<h2>MCMC Trace - Full GP</h2>
<ul>
<li><p>MCMC samples: 50, 000</p></li>
<li><p>Acceptance rate: 51.7%</p></li>
<li><p>Running time: 157.3s</p></li>
<li><p>Convergence: <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\tau^2\)</span> seem to reach convergence, since their trace plot don’t have many flat areas, and the density distribution appear to be unimodal and symmetric, indicating precise estimation</p></li>
<li><p>Convergence: trace plot of <span class="math inline">\(\phi\)</span> tend to have a skewed distribution that does not look ideal and there are a lot of flat sections in its trace plot as well.</p></li>
</ul>
<div style="font-size:0.7em;">
<div class="columns">
<div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Empirical mean, standard deviation and standard error</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">SD</th>
<th style="text-align: center;">Naive SE</th>
<th style="text-align: center;">Time-series SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.4683</td>
<td style="text-align: center;">0.05980</td>
<td style="text-align: center;">2.674e-04</td>
<td style="text-align: center;">0.0010711</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.1730</td>
<td style="text-align: center;">0.01491</td>
<td style="text-align: center;">6.668e-05</td>
<td style="text-align: center;">0.0002933</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">22.4706</td>
<td style="text-align: center;">5.42120</td>
<td style="text-align: center;">2.424e-02</td>
<td style="text-align: center;">0.3252332</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Quantiles for each variable</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">2.5%</th>
<th style="text-align: center;">25%</th>
<th style="text-align: center;">50%</th>
<th style="text-align: center;">75%</th>
<th style="text-align: center;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.3611</td>
<td style="text-align: center;">0.4258</td>
<td style="text-align: center;">0.4648</td>
<td style="text-align: center;">0.5058</td>
<td style="text-align: center;">0.5928</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.1459</td>
<td style="text-align: center;">0.1626</td>
<td style="text-align: center;">0.1724</td>
<td style="text-align: center;">0.1824</td>
<td style="text-align: center;">0.2040</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">10.6424</td>
<td style="text-align: center;">18.8733</td>
<td style="text-align: center;">23.2973</td>
<td style="text-align: center;">26.9326</td>
<td style="text-align: center;">29.8832</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="mcmc-trace---full-gp-1" class="slide level2 smaller">
<h2>MCMC Trace - Full GP</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/Theta_Trace_Bayes.png"></p>
</div><div class="column" style="width:50%;">
<p><img src="./presentation.assets/Trace_Bayes.png" style="zoom:10%;"></p>
</div>
</div>
</section>
<section id="mcmc-trace---low-rank-gp" class="slide level2 smaller">
<h2>MCMC Trace - Low Rank GP</h2>
<ul>
<li>MCMC samples: 50, 000</li>
<li>Acceptance rate: 7.71%</li>
<li>knots grid: <span class="math inline">\(6\times6\)</span></li>
<li>Running time: 29.8s</li>
<li>Convergence: Like the fullGP model, the trace plot and density plot of <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\tau^2\)</span> suggest convergence, but may not as good as fullGP model since there are more fluctuation in the plots</li>
<li>The density plot of <span class="math inline">\(\phi\)</span> is still skewed distributed, but according to the trace plot the convergence performance is better than fullGP model.</li>
</ul>
<div style="font-size:0.7em;">
<div class="columns">
<div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Empirical mean, standard deviation and standard error</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">SD</th>
<th style="text-align: center;">Naive SE</th>
<th style="text-align: center;">Time-series SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.2024</td>
<td style="text-align: center;">0.05776</td>
<td style="text-align: center;">0.0002583</td>
<td style="text-align: center;">0.002145</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.3579</td>
<td style="text-align: center;">0.05400</td>
<td style="text-align: center;">0.0002415</td>
<td style="text-align: center;">0.002185</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">0.2537</td>
<td style="text-align: center;">0.07618</td>
<td style="text-align: center;">0.0003407</td>
<td style="text-align: center;">0.003548</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Quantiles for each variable</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">2.5%</th>
<th style="text-align: center;">25%</th>
<th style="text-align: center;">50%</th>
<th style="text-align: center;">75%</th>
<th style="text-align: center;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.1067</td>
<td style="text-align: center;">0.1608</td>
<td style="text-align: center;">0.1968</td>
<td style="text-align: center;">0.2381</td>
<td style="text-align: center;">0.3300</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.2444</td>
<td style="text-align: center;">0.3236</td>
<td style="text-align: center;">0.3608</td>
<td style="text-align: center;">0.3959</td>
<td style="text-align: center;">0.4547</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">0.1533</td>
<td style="text-align: center;">0.1917</td>
<td style="text-align: center;">0.2422</td>
<td style="text-align: center;">0.3010</td>
<td style="text-align: center;">0.4288</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="mcmc-trace---low-rank-gp-1" class="slide level2 smaller">
<h2>MCMC Trace - Low Rank GP</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/Theta_Trace_LRBayes.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/LRGP_trace-1714053137368-82.png"></p>
</div>
</div>
</section>
<section id="mcmc-trace---nearest-neighbour-gp" class="slide level2 smaller">
<h2>MCMC Trace - Nearest Neighbour GP</h2>
<ul>
<li><p>We explored the trace plot of NNGP model but found that the previous prior settings did not fit to the NNGP latent and response model.</p></li>
<li><p>We changed the priors here as</p></li>
<li><p><span class="math inline">\(\beta \sim N(0, 1000I_p)\)</span></p></li>
<li><p><span class="math inline">\(\phi \sim U(15, 60)\)</span></p>
<ul>
<li>Starting value: 30</li>
</ul></li>
<li><p><span class="math inline">\(\sigma^2 \sim Inv.G(2, 0.5)\)</span></p>
<ul>
<li>Starting value: 1</li>
</ul></li>
<li><p><span class="math inline">\(\tau^2 \sim Inv.G(2, 0.5)\)</span></p>
<ul>
<li>Starting value: 0.5</li>
</ul></li>
<li><p>Turning: <span class="math inline">\(\phi=2, \tau^2=0.2, \sigma^2=0.2\)</span>;</p></li>
<li><p>Nearest Neighbor: 10</p></li>
</ul>
</section>
<section id="mcmc-trace---nearest-neighbour-gp-1" class="slide level2 smaller">
<h2>MCMC Trace - Nearest Neighbour GP</h2>
<ul>
<li><p>Acceptance Rate: 17.92%</p></li>
<li><p>Running time: 92.4s</p></li>
<li><p>MCMC Results for Both Intent and Response NNGP Models</p>
<ul>
<li><p>The trace plot of <span class="math inline">\(\sigma^2, \tau^2\)</span> show convergence</p></li>
<li><p>The trace plot of <span class="math inline">\(\phi\)</span> does not settle around a particular value and instead shows considerable movement across a wide range of values, indicating convergence of <span class="math inline">\(\phi\)</span> here is not ideal.</p></li>
</ul></li>
</ul>
<div style="font-size:0.7em;">
<div class="columns">
<div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Empirical mean, standard deviation and standard error</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">SD</th>
<th style="text-align: center;">Naive SE</th>
<th style="text-align: center;">Time-series SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.5908</td>
<td style="text-align: center;">0.06990</td>
<td style="text-align: center;">3.126e-04</td>
<td style="text-align: center;">0.001117</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.1614</td>
<td style="text-align: center;">0.01485</td>
<td style="text-align: center;">6.639e-05</td>
<td style="text-align: center;">0.000346</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">30.4587</td>
<td style="text-align: center;">9.31411</td>
<td style="text-align: center;">4.165e-02</td>
<td style="text-align: center;">0.532808</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<div style="text-align:center;">
<p><strong>Quantiles for each variable</strong></p>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">2.5%</th>
<th style="text-align: center;">25%</th>
<th style="text-align: center;">50%</th>
<th style="text-align: center;">75%</th>
<th style="text-align: center;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">0.4650</td>
<td style="text-align: center;">0.5425</td>
<td style="text-align: center;">0.5869</td>
<td style="text-align: center;">0.6347</td>
<td style="text-align: center;">0.7395</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">0.1352</td>
<td style="text-align: center;">0.1511</td>
<td style="text-align: center;">0.1605</td>
<td style="text-align: center;">0.1707</td>
<td style="text-align: center;">0.1918</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">16.6526</td>
<td style="text-align: center;">23.2558</td>
<td style="text-align: center;">29.1885</td>
<td style="text-align: center;">36.2258</td>
<td style="text-align: center;">52.5989</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="mcmc-trace---nearest-neighbour-gp-2" class="slide level2 smaller">
<h2>MCMC Trace - Nearest Neighbour GP</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="text-align:center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./presentation.assets/Trace_NNBayes(Response).png"></p>
<figcaption>Response Model</figcaption>
</figure>
</div>
</div>
</div><div class="column" style="width:50%;">
<div style="text-align:center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./presentation.assets/Trace_NNBayes-1714047587608-44.png"></p>
<figcaption>Latent Model</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="mcmc-diagnoses---full-gp" class="slide level2 smaller">
<h2>MCMC Diagnoses - Full GP</h2>
<div style="font-size:0.7em;">
<p><strong>Gelman Dignostic:</strong></p>
<ul>
<li>We changed the starting values and ran MCMC for each model for 3 times to gain the plot of shrink factor that considers within-chain variance and between-chain variance.</li>
<li>In fullGP model, given multiple runs, the shrink factors of <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\phi\)</span> are quickly drop to 1, that show good convergence, while <span class="math inline">\(\tau^2\)</span> ’s plot drops a bit slowly.</li>
<li>Multivariate PSRF(Potential Scale Reduction Factor): 1 (Indicates convergence as well)</li>
</ul>
</div>
<div style="text-align:center;">
<p><img src="./presentation.assets/GelmanDiag_Bayes-1714001972454-20.png" style="zoom: 7%;"></p>
</div>
</section>
<section id="mcmc-diagnoses---lrgp" class="slide level2 smaller">
<h2>MCMC Diagnoses - LRGP</h2>
<p><strong>Gelman Dignostic</strong></p>
<ul>
<li>Lack of convergence according to the fluctuation of the plots of all the parameters</li>
<li>Multivariate PSRF: 1.03</li>
</ul>
<div style="text-align:center;">
<p><img src="./presentation.assets/GelmanDiag_LRBayes-1714047790183-46.png" style="zoom:8%;"></p>
</div>
</section>
<section id="mcmc-diagnoses---nngp" class="slide level2 smaller">
<h2>MCMC Diagnoses - NNGP</h2>
<div style="font-size:0.8em;">
<p><strong>Gelman Dignostic</strong></p>
<ul>
<li>All the plots are dropped quickly to 1 -&gt; Convergence</li>
<li><span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\tau^2\)</span> show peaks at the start of their PSRF plots</li>
<li>Multivariate PSRF: 1</li>
</ul>
</div>
<div style="text-align:center;">
<p><img src="./presentation.assets/GelmanDiag_NNBayes-1714047843853-48.png" style="zoom:8%;"></p>
</div>
</section>
<section id="mcmc-diagnoses---summary" class="slide level2 smaller">
<h2>MCMC Diagnoses - Summary</h2>
<div style="font-size:0.8em;">
<table>
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Full GP</th>
<th style="text-align: center;">LRGP</th>
<th style="text-align: center;">NNGP<br>(latent)</th>
<th style="text-align: center;">NNGP<br>(Response)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">$DIC</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">bar.D</td>
<td style="text-align: center;">-532.3148</td>
<td style="text-align: center;">179.1369</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: center;">D.bar.Omega</td>
<td style="text-align: center;">-775.2592</td>
<td style="text-align: center;">164.0365</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: center;">pD</td>
<td style="text-align: center;">242.9444</td>
<td style="text-align: center;">15.1004</td>
<td style="text-align: center;">245.9763</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DIC</td>
<td style="text-align: center;">-289.3703</td>
<td style="text-align: center;">194.2373</td>
<td style="text-align: center;">880.0929</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: center;">L</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-194.0702</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$GP</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">G</td>
<td style="text-align: center;">61.08594</td>
<td style="text-align: center;">293.8502</td>
<td style="text-align: center;">61.19716</td>
<td style="text-align: center;">340.3536</td>
</tr>
<tr class="odd">
<td style="text-align: center;">P</td>
<td style="text-align: center;">138.35194</td>
<td style="text-align: center;">323.2817</td>
<td style="text-align: center;">141.61156</td>
<td style="text-align: center;">479.2075</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">199.43788</td>
<td style="text-align: center;">617.1320</td>
<td style="text-align: center;">202.80872</td>
<td style="text-align: center;">819.5612</td>
</tr>
<tr class="odd">
<td style="text-align: center;">$GRS</td>
<td style="text-align: center;">663.4488</td>
<td style="text-align: center;">-156.3317</td>
<td style="text-align: center;">653.3704</td>
<td style="text-align: center;">-272.9311</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="mcmc-diagnoses---summary-1" class="slide level2 smaller">
<h2>MCMC Diagnoses - Summary</h2>
<table>
<colgroup>
<col style="width: 27%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 23%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Effective Sample Size</th>
<th style="text-align: center;">Full GP</th>
<th style="text-align: center;">LRGP</th>
<th style="text-align: center;">NNGP<br>(latent)</th>
<th style="text-align: center;">NNGP<br>(Response)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: center;">3445.5804</td>
<td style="text-align: center;">725.3773</td>
<td style="text-align: center;">3912.5011</td>
<td style="text-align: center;">3444.001</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\tau^2\)</span></td>
<td style="text-align: center;">2586.3832</td>
<td style="text-align: center;">610.8421</td>
<td style="text-align: center;">1840.5902</td>
<td style="text-align: center;">3590.207</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: center;">293.4634</td>
<td style="text-align: center;">461.0998</td>
<td style="text-align: center;">305.5915</td>
<td style="text-align: center;">2941.707</td>
</tr>
</tbody>
</table>
</section>
<section id="validation---full-gp" class="slide level2 smaller">
<h2>Validation - Full GP</h2>
<ul>
<li>Testing set: 25% of the data</li>
<li>Most of the points are close to reference line (<span class="math inline">\(slope=1\)</span> )</li>
<li>Low confidence intervals among all the models</li>
<li>Nearly no spatial dependence on the semivariogram</li>
<li>Low residual values (close to 0.1)</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="./presentation.assets/PredictvsTest_Bayes-1714000870814-9.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/Residual_Bayes-1714000947505-11.png"></p>
</div>
</div>
</section>
<section id="validation---low-rank-gp" class="slide level2 smaller">
<h2>Validation - Low Rank GP</h2>
<ul>
<li>More deviation points from reference line comparing to full rank GP model</li>
<li>Higher confidence intervals than full GP model</li>
<li>Less spatial dependence than LM model</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/PredictvsTest_LRBayes-1714048911319-50.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/Low%20Rank%20Residual_Bayes-1714048934393-52.png"></p>
</div>
</div>
</section>
<section id="validation---nngp" class="slide level2 smaller">
<h2>Validation - NNGP</h2>
<ul>
<li>According to residuals, latent model is significantly better than response model, the latter one seems failing to capture spatial variance that still can notice in the semivariogram.</li>
<li>In terms of the distribution of residuals, the two models tend to have similar spatial patterns that points with larger residuals are both gathered around the eastern part of the research region.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/NN_Residual_Bayes(Response)-1714052616731-72.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/NN_Residual_Bayes-1714052664959-74.png"></p>
</div>
</div>
</section>
<section id="validation---nngp-1" class="slide level2 smaller">
<h2>Validation - NNGP</h2>
<ul>
<li>Comparing two models’ prediction on validation data, the scatters from latent model are closer to the reference line and has narrower confidence intervals generally.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/PredictvsTest_NNBayes(Response)-1714052707321-76.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/PredictvsTest_NNBayes-1714052735526-78.png"></p>
</div>
</div>
</section>
<section id="prediction" class="slide level2 smaller">
<h2>Prediction</h2>
<div style="text-align:center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./presentation.assets/Prediction_Extra.png"></p>
<figcaption>Prediction for Points with Missing Values within Michigan</figcaption>
</figure>
</div>
</div>
</section>
<section id="further-attempts-non-stationary-model5" class="slide level2 smaller">
<h2>Further Attempts: Non-stationary Model<sup>1</sup></h2>
<p><strong>Model Description</strong></p>
<ul>
<li><span class="math inline">\(Y = X + \epsilon\)</span> where <span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></li>
<li><span class="math inline">\(X \sim MVN(\mu 1 + B\phi, diag[(p\exp[B\psi])^2])\)</span></li>
<li><span class="math inline">\(\phi \sim MVN(0, \Sigma_{\phi}\)</span>)</li>
<li><span class="math inline">\(\Sigma_{\phi} = (\tau_{\phi}^2[D_{\phi}-\alpha_{\phi}W_{\phi}]^{-1})\)</span></li>
</ul>
<p><strong>Priors</strong></p>
<ul>
<li><span class="math inline">\(\alpha_{\phi} \sim Beta(p_1,p_2)\)</span></li>
<li><span class="math inline">\(\tau_{\phi}^2 \sim Gamma(q_1,q_2)\)</span></li>
<li><span class="math inline">\(\rho \sim \text{Truncated Cauchy}(0, s)\)</span></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn5"><p>Ellefsen, K.J., and Van Gosen, B.S., 2020, Bayesian modeling of non-stationary, univariate, spatial data for the Earth sciences: U.S. Geological Survey Techniques and Methods, book 7, chap.&nbsp;C24, 20 p., https://doi.org/10.3133/tm7C24.</p></li></ol></aside></section>
<section id="further-attempts-non-stationary-model" class="slide level2">
<h2>Further Attempts: Non-stationary Model</h2>
<p><strong>Fitting Results</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/non_sta_residual_statistics.png"></p>
<div style="text-align:center; font-size:0.7em">
<p>Charts of Residuals</p>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/non_sta_residual_sng.png"></p>
<div style="text-align:center; font-size:0.7em">
<p>Signs of Residuals on Each Location</p>
</div>
</div>
</div>
</section>
<section id="further-attempts-non-stationary-model-1" class="slide level2">
<h2>Further Attempts: Non-stationary Model</h2>
<p><strong>Prediction results</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/non_sta_pred_mean.png"></p>
<div style="text-align:center; font-size:0.7em">
<p>Non-Stationary Model Prediction: Mean</p>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="./presentation.assets/non_sta_pred_sd.png"></p>
<div style="text-align:center; font-size:0.7em">
<p>Non-Stationary Model Prediction: Standard Deviation</p>
</div>
</div>
</div>
</section>
<section id="discussion-and-improvements" class="slide level2 smaller">
<h2>Discussion and Improvements</h2>
<ul>
<li><p>Scale</p></li>
<li><p>Cloud cover</p></li>
<li><p>Static</p></li>
<li><p>Response model vs Latent model</p>
<p>Response model’s performance on our dataset is not as good as latent model, which is probably caused by the setting of the priors since response model’s nugget term is within the covariance, may consider adjust the prior of NNGP model more meticulously.</p></li>
</ul>
</section>
<section id="thank-you" class="title-slide slide level1 center" style="text-align:center;">
<h1>Thank You!</h1>

</section>

<div class="footer footer-default">
<p>Map Mad Scientists</p>
</div>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>