---
title: "Final Project Presentation<br>Biostat 696"
author: "Map Mad Scientists<br>Kunxi Li, Haolin Li, Jiayuan Xiao"
format: 
  revealjs: 
    theme: [solarized, custom.sass]
    footer: "Map Mad Scientists"
editor: visual
---

## Motivation

::: {style="text-align:center;"}
**Light Pollution**

<img src="./presentation.assets/35732ace7b56363ff57b7f79f401ecb.jpg" alt="35732ace7b56363ff57b7f79f401ecb" style="zoom: 40%;"/>
:::

## Motivation: Continue {.smaller}

-   **Magnitude of object brightness**

    -   Range $[-26.73, 30]$
    -   Sun -26.73; full moon -12.6; faintest stars observable with naked eye +6

-   **Naked Eye Limiting Magnitude (`NELM`)**

-   **Magnitude Per Square Arcsecond (`MPSAS`)**
    $$
    NELM = \text{some complex function}(MPSAS)
    $$
    
    -   Range $[16 (darkest) - 22 (brightest)]$
    -   Measured by equipment (Sky Quality Meter)

## Data Source (Main) {.smaller}

**Globe at Night Project** ([Link](https://globeatnight.org/maps-data/))

-   Light pollution report at 29404 locations (2020)
-   Sky brightness measurement (`MPSAS`) at 2030 locations
-   Darker means higher `NELM`

::: {style="text-align:center;"}

<img src="./presentation.assets/2023-map.original.png" style="zoom: 50%;" />

:::



## Explanatory Variables {.smaller}

-   **Population Density**: Gridded Population of the World[^1]
-   **Land Price**: Data for: High-resolution land value maps reveal underestimation of conservation costs in the United States[^2]
-   **Electricity Consumption**: Global 1 km × 1 km gridded revised real gross domestic product and electricity consumption during 1992-2019 based on calibrated nighttime light data[^3]

[^1]: Center for International Earth Science Information Network - CIESIN - Columbia University. 2018. Gridded Population of the World, Version 4 (GPWv4): Population Density Adjusted to Match 2015 Revision UN WPP Country Totals, Revision 11. Palisades, New York: NASA Socioeconomic Data and Applications Center (SEDAC). https://doi.org/10.7927/H4F47M65. Accessed 22 04 2024.
[^2]: Nolte, Christoph (2020). Data for: High-resolution land value maps reveal underestimation of conservation costs in the United States \[Dataset\]. Dryad. https://doi.org/10.5061/dryad.np5hqbzq9
[^3]: Chen, Jiandong; Gao, Ming (2021). Global 1 km × 1 km gridded revised real gross domestic product and electricity consumption during 1992-2019 based on calibrated nighttime light data. figshare. Dataset. https://doi.org/10.6084/m9.figshare.17004523.v1

## Goal

-   Impute missing or damaged data in the original dataset (due to unofficial reports)
-   Predict light pollution in Ann Arbor Area and interpret in NELM
-   Discuss the impact of population density, land price and electricity consumption on the light pollution

## Our Model {.smaller}

$$
y(s) = \beta^Tx(s) + w(s) + \epsilon(s), s\in D
$$

**Response Variable**: 

- $y(s)$: `MPSAS` at location $S$ (Univariate)

**Explanatory Variables**
$$
x(s) = [x_1(s), x_2(s), x_3(s), x_4(s)]^T
$$

- $x_1$: Elevation
- $x_2$: Population Density
- $x_3$: Land Price
- $x_4$: Electricity Consumption

## Model Assumptions - GP {.smaller}

:::: {.columns}

::: {.column width="50%"}

- $w(s) \sim GP(0, \tau^2C(\cdot,\cdot))$

- Features

  - Rapid decay in covariance

  - Stationary, isotropic (?)

- Exponential kernel
  $$
  C(s, s') = \sigma^2 \exp{-\phi||s - s'||}
  $$

  - For simplicity
  - Interpretability


:::

::: {.column width="50%"}

::: {style="text-align:center;"}

![Nighttime Light Image Captured in NASA Worldview[^4]](./presentation.assets/snapshot-2021-05-03T00_00_00Z-1713928280926-2.png)

:::

::: {style="font-size:0.8em;"}

*Why not use night time light data as explanatory?*

- Means the same thing as light pollution
- Actual meaning of the model

:::

:::

::::

## Model Assumptions - Priors {.smaller}

-   $\beta \sim N(0, 1000I_p)$
    -   We assume independence between explanatory variables

-   $\phi \sim U(1, 10)$
    -   We assume large decay factor

-   $\sigma^2 \sim Inv.G(2, 2)$
    -   Chose because a webpage method

-   $\tau^2 \sim Inv.G(2, 0.1)$
    -   Chose because a webpage method


## Results - MCMC Trace {.smaller}

:::: {.columns}

::: {.column width="33%"}

![](./presentation.assets/Theta_Trace_sigma_Bayes.png)

:::

::: {.column width="33%"}

![](./presentation.assets/Theta_Trace_tau_Bayes.png)

:::

::: {.column width="33%"}

![](./presentation.assets/Theta_Trace_phi_Bayes-1714001656182-17.png)

:::

::::

## Results - MCMC Diagnose {.smaller}

**Final values**:

- $\beta = [a,b,c]^T, \sigma^2 = a, \tau^2 = a, \phi = a$

::: {style="text-align:center;"}

<img src="./presentation.assets/GelmanDiag_Bayes-1714001972454-20.png" style="zoom: 8%;" />

:::

## Results - Validation

- Testing set: 25% of the data

::: {style="text-align:center;"}

<img src="./presentation.assets/PredictvsTest_Bayes-1714000870814-9.png" style="zoom: 15%;" />

:::

## Results - Residuals

::: {style="text-align:center;"}

![](./presentation.assets/Residual_Bayes-1714000947505-11.png)

:::

## Result - Compare with Linear Model

::: {style="text-align:center;"}

![](./presentation.assets/Compare_LM_Bayes.png)

:::

## Low Rank GP {.smaller}

- Same priors, starting values, tuning values
- Same kernel (exponential)
- Knot size $\mathcal{K} = $
- Computing time: $\%$ in reduction (from …)

:::: {.columns}

::: {.column width="50%"}

![](./presentation.assets/PredictvsTest_LRBayes.png)

:::

::: {.column width="50%"}

![](./presentation.assets/Low Rank Residual_Bayes.png)

:::

::::



## Nearest Neighbour GP {.smaller}

- Same priors, starting values, tuning values
- Same kernel (exponential)
- Neighbour size: 10
- Computing time: $\%$ in reduction
- Almost as good as full rank GP

:::: {.columns}

::: {.column width="50%"}

![](./presentation.assets/PredictvsTest_NNBayes(Response).png)

:::

::: {.column width="50%"}

![](./presentation.assets/NN_Residual_Bayes(Response)-1714010822869-26.png)

:::

::::



## Prediction - Interpolating the damaged values

- With full rank GP model



## Prediction - Light Pollution in Ann Arbor

- With full rank GP model



## Attempts: Non-stationary Model



## Discussion on Improvements

-   Scale too large
-   Cloud cover issues
-   static, not temporal



::: {style="text-align:center;"}
# Thank You!
:::

[^4]: Román, M. O., Wang, Z., Sun, Q., Kalb, V., Miller, S. D., Molthan, A., … & Masuoka, E. J. (2018). NASA's Black Marble nighttime lights product suite. Remote Sensing of Environment, 210, 113-143, [doi:10.1016/j.rse.2018.03.017](https://doi.org/10.1016/j.rse.2018.03.017).
